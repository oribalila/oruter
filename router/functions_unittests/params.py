import sys

from pathlib import Path
from ipaddress import IPv4Address

from netaddr import EUI


sys.path.append(str(Path(__file__).resolve().parent.parent))
from protocols.arp import ARP
from protocols.ipv4 import IPv4
from protocols.ethernet import Ethernet


# -- Ethernet + ARP --
arp_ethernet_headers = [
    Ethernet(
        destination=EUI("FF-FF-FF-FF-FF-FF"),
        source=EUI("13-9D-10-F4-10-54"),
        ether_type=2054,
    ),
    Ethernet(
        destination=EUI("FF-FF-FF-FF-FF-FF"),
        source=EUI("3E-A5-89-2E-56-7C"),
        ether_type=2054,
    ),
    Ethernet(
        destination=EUI("FF-FF-FF-FF-FF-FF"),
        source=EUI("6B-4E-6C-4B-CD-C0"),
        ether_type=2054,
    ),
    Ethernet(
        destination=EUI("FF-FF-FF-FF-FF-FF"),
        source=EUI("4A-72-0F-70-9E-01"),
        ether_type=2054,
    ),
    Ethernet(
        destination=EUI("FF-FF-FF-FF-FF-FF"),
        source=EUI("E2-B8-C5-80-D5-9D"),
        ether_type=2054,
    ),
    Ethernet(
        destination=EUI("FF-FF-FF-FF-FF-FF"),
        source=EUI("6B-E4-E8-11-9F-F8"),
        ether_type=2054,
    ),
    Ethernet(
        destination=EUI("FF-FF-FF-FF-FF-FF"),
        source=EUI("F8-C9-F6-B3-F1-8B"),
        ether_type=2054,
    ),
    Ethernet(
        destination=EUI("FF-FF-FF-FF-FF-FF"),
        source=EUI("AF-84-40-62-77-DB"),
        ether_type=2054,
    ),
    Ethernet(
        destination=EUI("FF-FF-FF-FF-FF-FF"),
        source=EUI("29-22-BB-CF-26-28"),
        ether_type=2054,
    ),
    Ethernet(
        destination=EUI("FF-FF-FF-FF-FF-FF"),
        source=EUI("4A-48-C2-F6-1D-A4"),
        ether_type=2054,
    ),
]
arp_ethernet_headers_bytes = [
    b"\xff\xff\xff\xff\xff\xff\x13\x9d\x10\xf4\x10T\x08\x06",
    b"\xff\xff\xff\xff\xff\xff>\xa5\x89.V|\x08\x06",
    b"\xff\xff\xff\xff\xff\xffkNlK\xcd\xc0\x08\x06",
    b"\xff\xff\xff\xff\xff\xffJr\x0fp\x9e\x01\x08\x06",
    b"\xff\xff\xff\xff\xff\xff\xe2\xb8\xc5\x80\xd5\x9d\x08\x06",
    b"\xff\xff\xff\xff\xff\xffk\xe4\xe8\x11\x9f\xf8\x08\x06",
    b"\xff\xff\xff\xff\xff\xff\xf8\xc9\xf6\xb3\xf1\x8b\x08\x06",
    b"\xff\xff\xff\xff\xff\xff\xaf\x84@bw\xdb\x08\x06",
    b'\xff\xff\xff\xff\xff\xff)"\xbb\xcf&(\x08\x06',
    b"\xff\xff\xff\xff\xff\xffJH\xc2\xf6\x1d\xa4\x08\x06",
]

arp_headers = [
    ARP(
        hardware_type=1,
        protocol_type=2048,
        hardware_size=6,
        protocol_size=4,
        opcode=1,
        sender_hardware=EUI("13-9D-10-F4-10-54"),
        sender_protocol=IPv4Address("241.178.223.68"),
        target_hardware=EUI("00-00-00-00-00-00"),
        target_protocol=IPv4Address("106.195.203.37"),
    ),
    ARP(
        hardware_type=1,
        protocol_type=2048,
        hardware_size=6,
        protocol_size=4,
        opcode=1,
        sender_hardware=EUI("3E-A5-89-2E-56-7C"),
        sender_protocol=IPv4Address("171.117.197.54"),
        target_hardware=EUI("00-00-00-00-00-00"),
        target_protocol=IPv4Address("13.146.184.131"),
    ),
    ARP(
        hardware_type=1,
        protocol_type=2048,
        hardware_size=6,
        protocol_size=4,
        opcode=1,
        sender_hardware=EUI("6B-4E-6C-4B-CD-C0"),
        sender_protocol=IPv4Address("90.222.250.195"),
        target_hardware=EUI("00-00-00-00-00-00"),
        target_protocol=IPv4Address("60.224.99.233"),
    ),
    ARP(
        hardware_type=1,
        protocol_type=2048,
        hardware_size=6,
        protocol_size=4,
        opcode=1,
        sender_hardware=EUI("4A-72-0F-70-9E-01"),
        sender_protocol=IPv4Address("23.62.207.173"),
        target_hardware=EUI("00-00-00-00-00-00"),
        target_protocol=IPv4Address("96.94.227.253"),
    ),
    ARP(
        hardware_type=1,
        protocol_type=2048,
        hardware_size=6,
        protocol_size=4,
        opcode=1,
        sender_hardware=EUI("E2-B8-C5-80-D5-9D"),
        sender_protocol=IPv4Address("67.33.91.60"),
        target_hardware=EUI("00-00-00-00-00-00"),
        target_protocol=IPv4Address("172.244.192.115"),
    ),
    ARP(
        hardware_type=1,
        protocol_type=2048,
        hardware_size=6,
        protocol_size=4,
        opcode=1,
        sender_hardware=EUI("6B-E4-E8-11-9F-F8"),
        sender_protocol=IPv4Address("76.67.64.108"),
        target_hardware=EUI("00-00-00-00-00-00"),
        target_protocol=IPv4Address("19.159.149.234"),
    ),
    ARP(
        hardware_type=1,
        protocol_type=2048,
        hardware_size=6,
        protocol_size=4,
        opcode=1,
        sender_hardware=EUI("F8-C9-F6-B3-F1-8B"),
        sender_protocol=IPv4Address("37.205.157.201"),
        target_hardware=EUI("00-00-00-00-00-00"),
        target_protocol=IPv4Address("220.181.159.174"),
    ),
    ARP(
        hardware_type=1,
        protocol_type=2048,
        hardware_size=6,
        protocol_size=4,
        opcode=1,
        sender_hardware=EUI("AF-84-40-62-77-DB"),
        sender_protocol=IPv4Address("205.133.200.196"),
        target_hardware=EUI("00-00-00-00-00-00"),
        target_protocol=IPv4Address("229.114.163.242"),
    ),
    ARP(
        hardware_type=1,
        protocol_type=2048,
        hardware_size=6,
        protocol_size=4,
        opcode=1,
        sender_hardware=EUI("29-22-BB-CF-26-28"),
        sender_protocol=IPv4Address("224.209.170.2"),
        target_hardware=EUI("00-00-00-00-00-00"),
        target_protocol=IPv4Address("232.168.240.189"),
    ),
    ARP(
        hardware_type=1,
        protocol_type=2048,
        hardware_size=6,
        protocol_size=4,
        opcode=1,
        sender_hardware=EUI("4A-48-C2-F6-1D-A4"),
        sender_protocol=IPv4Address("119.108.122.255"),
        target_hardware=EUI("00-00-00-00-00-00"),
        target_protocol=IPv4Address("38.31.142.175"),
    ),
]
arp_headers_bytes = [
    b"\x00\x01\x08\x00\x06\x04\x00\x01\x13\x9d\x10\xf4\x10T\xf1\xb2\xdfD\x00\x00\x00\x00\x00\x00j\xc3\xcb%",
    b"\x00\x01\x08\x00\x06\x04\x00\x01>\xa5\x89.V|\xabu\xc56\x00\x00\x00\x00\x00\x00\r\x92\xb8\x83",
    b"\x00\x01\x08\x00\x06\x04\x00\x01kNlK\xcd\xc0Z\xde\xfa\xc3\x00\x00\x00\x00\x00\x00<\xe0c\xe9",
    b"\x00\x01\x08\x00\x06\x04\x00\x01Jr\x0fp\x9e\x01\x17>\xcf\xad\x00\x00\x00\x00\x00\x00`^\xe3\xfd",
    b"\x00\x01\x08\x00\x06\x04\x00\x01\xe2\xb8\xc5\x80\xd5\x9dC![<\x00\x00\x00\x00\x00\x00\xac\xf4\xc0s",
    b"\x00\x01\x08\x00\x06\x04\x00\x01k\xe4\xe8\x11\x9f\xf8LC@l\x00\x00\x00\x00\x00\x00\x13\x9f\x95\xea",
    b"\x00\x01\x08\x00\x06\x04\x00\x01\xf8\xc9\xf6\xb3\xf1\x8b%\xcd\x9d\xc9\x00\x00\x00\x00\x00\x00\xdc\xb5\x9f\xae",
    b"\x00\x01\x08\x00\x06\x04\x00\x01\xaf\x84@bw\xdb\xcd\x85\xc8\xc4\x00\x00\x00\x00\x00\x00\xe5r\xa3\xf2",
    b'\x00\x01\x08\x00\x06\x04\x00\x01)"\xbb\xcf&(\xe0\xd1\xaa\x02\x00\x00\x00\x00\x00\x00\xe8\xa8\xf0\xbd',
    b"\x00\x01\x08\x00\x06\x04\x00\x01JH\xc2\xf6\x1d\xa4wlz\xff\x00\x00\x00\x00\x00\x00&\x1f\x8e\xaf",
]

# -- Ethernet + IPv4 + ICMP --
ipv4_ethernet_headers = [
    Ethernet(
        destination=EUI("08-96-D8-69-6D-46"),
        source=EUI("F4-59-A3-A8-2C-B4"),
        ether_type=2048,
    ),
    Ethernet(
        destination=EUI("F4-59-A3-A8-2C-B4"),
        source=EUI("38-43-50-3A-32-66"),
        ether_type=2048,
    ),
    Ethernet(
        destination=EUI("38-43-50-3A-32-66"),
        source=EUI("04-E5-06-E6-F7-C6"),
        ether_type=2048,
    ),
    Ethernet(
        destination=EUI("04-E5-06-E6-F7-C6"),
        source=EUI("44-55-F5-48-F5-78"),
        ether_type=2048,
    ),
    Ethernet(
        destination=EUI("44-55-F5-48-F5-78"),
        source=EUI("A4-01-3F-24-4A-C0"),
        ether_type=2048,
    ),
    Ethernet(
        destination=EUI("A4-01-3F-24-4A-C0"),
        source=EUI("BB-95-14-7B-E1-06"),
        ether_type=2048,
    ),
    Ethernet(
        destination=EUI("BB-95-14-7B-E1-06"),
        source=EUI("C2-87-E5-16-5B-C9"),
        ether_type=2048,
    ),
    Ethernet(
        destination=EUI("C2-87-E5-16-5B-C9"),
        source=EUI("DF-BE-16-0A-6E-8A"),
        ether_type=2048,
    ),
    Ethernet(
        destination=EUI("DF-BE-16-0A-6E-8A"),
        source=EUI("39-2E-D9-0A-9B-36"),
        ether_type=2048,
    ),
    Ethernet(
        destination=EUI("39-2E-D9-0A-9B-36"),
        source=EUI("15-7F-2F-09-6A-53"),
        ether_type=2048,
    ),
]
ipv4_ethernet_headers_bytes = [
    b"\x08\x96\xd8imF\xf4Y\xa3\xa8,\xb4\x08\x00",
    b"\xf4Y\xa3\xa8,\xb48CP:2f\x08\x00",
    b"8CP:2f\x04\xe5\x06\xe6\xf7\xc6\x08\x00",
    b"\x04\xe5\x06\xe6\xf7\xc6DU\xf5H\xf5x\x08\x00",
    b"DU\xf5H\xf5x\xa4\x01?$J\xc0\x08\x00",
    b"\xa4\x01?$J\xc0\xbb\x95\x14{\xe1\x06\x08\x00",
    b"\xbb\x95\x14{\xe1\x06\xc2\x87\xe5\x16[\xc9\x08\x00",
    b"\xc2\x87\xe5\x16[\xc9\xdf\xbe\x16\nn\x8a\x08\x00",
    b"\xdf\xbe\x16\nn\x8a9.\xd9\n\x9b6\x08\x00",
    b"9.\xd9\n\x9b6\x15\x7f/\tjS\x08\x00",
]
ipv4_ethernet_headers = [
    Ethernet(
        destination=EUI("08-96-D8-69-6D-46"),
        source=EUI("F4-59-A3-A8-2C-B4"),
        ether_type=2048,
    ),
    Ethernet(
        destination=EUI("F4-59-A3-A8-2C-B4"),
        source=EUI("38-43-50-3A-32-66"),
        ether_type=2048,
    ),
    Ethernet(
        destination=EUI("38-43-50-3A-32-66"),
        source=EUI("04-E5-06-E6-F7-C6"),
        ether_type=2048,
    ),
    Ethernet(
        destination=EUI("04-E5-06-E6-F7-C6"),
        source=EUI("44-55-F5-48-F5-78"),
        ether_type=2048,
    ),
    Ethernet(
        destination=EUI("44-55-F5-48-F5-78"),
        source=EUI("A4-01-3F-24-4A-C0"),
        ether_type=2048,
    ),
    Ethernet(
        destination=EUI("A4-01-3F-24-4A-C0"),
        source=EUI("BB-95-14-7B-E1-06"),
        ether_type=2048,
    ),
    Ethernet(
        destination=EUI("BB-95-14-7B-E1-06"),
        source=EUI("C2-87-E5-16-5B-C9"),
        ether_type=2048,
    ),
    Ethernet(
        destination=EUI("C2-87-E5-16-5B-C9"),
        source=EUI("DF-BE-16-0A-6E-8A"),
        ether_type=2048,
    ),
    Ethernet(
        destination=EUI("DF-BE-16-0A-6E-8A"),
        source=EUI("39-2E-D9-0A-9B-36"),
        ether_type=2048,
    ),
    Ethernet(
        destination=EUI("39-2E-D9-0A-9B-36"),
        source=EUI("15-7F-2F-09-6A-53"),
        ether_type=2048,
    ),
]
ipv4_ethernet_headers_bytes = [
    b"\x08\x96\xd8imF\xf4Y\xa3\xa8,\xb4\x08\x00",
    b"\xf4Y\xa3\xa8,\xb48CP:2f\x08\x00",
    b"8CP:2f\x04\xe5\x06\xe6\xf7\xc6\x08\x00",
    b"\x04\xe5\x06\xe6\xf7\xc6DU\xf5H\xf5x\x08\x00",
    b"DU\xf5H\xf5x\xa4\x01?$J\xc0\x08\x00",
    b"\xa4\x01?$J\xc0\xbb\x95\x14{\xe1\x06\x08\x00",
    b"\xbb\x95\x14{\xe1\x06\xc2\x87\xe5\x16[\xc9\x08\x00",
    b"\xc2\x87\xe5\x16[\xc9\xdf\xbe\x16\nn\x8a\x08\x00",
    b"\xdf\xbe\x16\nn\x8a9.\xd9\n\x9b6\x08\x00",
    b"9.\xd9\n\x9b6\x15\x7f/\tjS\x08\x00",
]

ipv4_original_headers = [
    IPv4(
        header_length=20,
        dsf=0,
        total_length=37,
        identification=3800,
        flags=2,
        fragment_offset=0,
        ttl=64,
        protocol=1,
        checksum=15336,
        source=IPv4Address("178.238.130.58"),
        destination=IPv4Address("253.182.189.56"),
        options=b"",
    ),
    IPv4(
        header_length=20,
        dsf=0,
        total_length=37,
        identification=3801,
        flags=2,
        fragment_offset=0,
        ttl=64,
        protocol=1,
        checksum=5016,
        source=IPv4Address("88.130.143.184"),
        destination=IPv4Address("214.1.90.43"),
        options=b"",
    ),
    IPv4(
        header_length=20,
        dsf=0,
        total_length=37,
        identification=3802,
        flags=2,
        fragment_offset=0,
        ttl=64,
        protocol=1,
        checksum=50795,
        source=IPv4Address("126.79.102.150"),
        destination=IPv4Address("240.12.144.160"),
        options=b"",
    ),
    IPv4(
        header_length=20,
        dsf=0,
        total_length=37,
        identification=3803,
        flags=2,
        fragment_offset=0,
        ttl=64,
        protocol=1,
        checksum=39109,
        source=IPv4Address("75.104.193.165"),
        destination=IPv4Address("89.148.44.150"),
        options=b"",
    ),
    IPv4(
        header_length=20,
        dsf=0,
        total_length=37,
        identification=3804,
        flags=2,
        fragment_offset=0,
        ttl=64,
        protocol=1,
        checksum=12968,
        source=IPv4Address("225.54.78.25"),
        destination=IPv4Address("216.117.241.142"),
        options=b"",
    ),
    IPv4(
        header_length=20,
        dsf=0,
        total_length=37,
        identification=3805,
        flags=2,
        fragment_offset=0,
        ttl=64,
        protocol=1,
        checksum=12017,
        source=IPv4Address("127.255.157.86"),
        destination=IPv4Address("119.2.104.178"),
        options=b"",
    ),
    IPv4(
        header_length=20,
        dsf=0,
        total_length=37,
        identification=3806,
        flags=2,
        fragment_offset=0,
        ttl=64,
        protocol=1,
        checksum=10506,
        source=IPv4Address("156.28.76.196"),
        destination=IPv4Address("119.162.162.109"),
        options=b"",
    ),
    IPv4(
        header_length=20,
        dsf=0,
        total_length=37,
        identification=3807,
        flags=2,
        fragment_offset=0,
        ttl=64,
        protocol=1,
        checksum=20645,
        source=IPv4Address("163.102.232.71"),
        destination=IPv4Address("0.53.79.113"),
        options=b"",
    ),
    IPv4(
        header_length=20,
        dsf=0,
        total_length=37,
        identification=3808,
        flags=2,
        fragment_offset=0,
        ttl=64,
        protocol=1,
        checksum=21455,
        source=IPv4Address("235.140.214.99"),
        destination=IPv4Address("156.55.122.1"),
        options=b"",
    ),
    IPv4(
        header_length=20,
        dsf=0,
        total_length=37,
        identification=3809,
        flags=2,
        fragment_offset=0,
        ttl=64,
        protocol=1,
        checksum=61760,
        source=IPv4Address("181.45.185.107"),
        destination=IPv4Address("45.196.158.89"),
        options=b"",
    ),
]
ipv4_altered_headers = [
    IPv4(
        header_length=20,
        dsf=0,
        total_length=37,
        identification=4058,
        flags=0,
        fragment_offset=0,
        ttl=63,
        protocol=1,
        checksum=31718,
        source=IPv4Address("253.182.189.56"),
        destination=IPv4Address("178.238.130.58"),
        options=b"",
    ),
    IPv4(
        header_length=20,
        dsf=0,
        total_length=37,
        identification=6385,
        flags=0,
        fragment_offset=0,
        ttl=63,
        protocol=1,
        checksum=19072,
        source=IPv4Address("214.1.90.43"),
        destination=IPv4Address("88.130.143.184"),
        options=b"",
    ),
    IPv4(
        header_length=20,
        dsf=0,
        total_length=37,
        identification=21979,
        flags=0,
        fragment_offset=0,
        ttl=63,
        protocol=1,
        checksum=49258,
        source=IPv4Address("240.12.144.160"),
        destination=IPv4Address("126.79.102.150"),
        options=b"",
    ),
    IPv4(
        header_length=20,
        dsf=0,
        total_length=37,
        identification=24337,
        flags=0,
        fragment_offset=0,
        ttl=63,
        protocol=1,
        checksum=35215,
        source=IPv4Address("89.148.44.150"),
        destination=IPv4Address("75.104.193.165"),
        options=b"",
    ),
    IPv4(
        header_length=20,
        dsf=0,
        total_length=37,
        identification=38416,
        flags=0,
        fragment_offset=0,
        ttl=63,
        protocol=1,
        checksum=60531,
        source=IPv4Address("216.117.241.142"),
        destination=IPv4Address("225.54.78.25"),
        options=b"",
    ),
    IPv4(
        header_length=20,
        dsf=0,
        total_length=37,
        identification=17100,
        flags=0,
        fragment_offset=0,
        ttl=63,
        protocol=1,
        checksum=15362,
        source=IPv4Address("119.2.104.178"),
        destination=IPv4Address("127.255.157.86"),
        options=b"",
    ),
    IPv4(
        header_length=20,
        dsf=0,
        total_length=37,
        identification=39971,
        flags=0,
        fragment_offset=0,
        ttl=63,
        protocol=1,
        checksum=56516,
        source=IPv4Address("119.162.162.109"),
        destination=IPv4Address("156.28.76.196"),
        options=b"",
    ),
    IPv4(
        header_length=20,
        dsf=0,
        total_length=37,
        identification=64921,
        flags=0,
        fragment_offset=0,
        ttl=63,
        protocol=1,
        checksum=41706,
        source=IPv4Address("0.53.79.113"),
        destination=IPv4Address("163.102.232.71"),
        options=b"",
    ),
    IPv4(
        header_length=20,
        dsf=0,
        total_length=37,
        identification=65490,
        flags=0,
        fragment_offset=0,
        ttl=63,
        protocol=1,
        checksum=41948,
        source=IPv4Address("156.55.122.1"),
        destination=IPv4Address("235.140.214.99"),
        options=b"",
    ),
    IPv4(
        header_length=20,
        dsf=0,
        total_length=37,
        identification=8243,
        flags=0,
        fragment_offset=0,
        ttl=63,
        protocol=1,
        checksum=8431,
        source=IPv4Address("45.196.158.89"),
        destination=IPv4Address("181.45.185.107"),
        options=b"",
    ),
]
ipv4_headers = ipv4_original_headers + ipv4_altered_headers
ipv4_original_headers_bytes = [
    b"E\x00\x00%\x0e\xd8@\x00@\x01;\xe8\xb2\xee\x82:\xfd\xb6\xbd8",
    b"E\x00\x00%\x0e\xd9@\x00@\x01\x13\x98X\x82\x8f\xb8\xd6\x01Z+",
    b"E\x00\x00%\x0e\xda@\x00@\x01\xc6k~Of\x96\xf0\x0c\x90\xa0",
    b"E\x00\x00%\x0e\xdb@\x00@\x01\x98\xc5Kh\xc1\xa5Y\x94,\x96",
    b"E\x00\x00%\x0e\xdc@\x00@\x012\xa8\xe16N\x19\xd8u\xf1\x8e",
    b"E\x00\x00%\x0e\xdd@\x00@\x01.\xf1\x7f\xff\x9dVw\x02h\xb2",
    b"E\x00\x00%\x0e\xde@\x00@\x01)\n\x9c\x1cL\xc4w\xa2\xa2m",
    b"E\x00\x00%\x0e\xdf@\x00@\x01P\xa5\xa3f\xe8G\x005Oq",
    b"E\x00\x00%\x0e\xe0@\x00@\x01S\xcf\xeb\x8c\xd6c\x9c7z\x01",
    b"E\x00\x00%\x0e\xe1@\x00@\x01\xf1@\xb5-\xb9k-\xc4\x9eY",
]
ipv4_altered_headers_bytes = [
    b"E\x00\x00%\x0f\xda\x00\x00?\x01{\xe6\xfd\xb6\xbd8\xb2\xee\x82:",
    b"E\x00\x00%\x18\xf1\x00\x00?\x01J\x80\xd6\x01Z+X\x82\x8f\xb8",
    b"E\x00\x00%U\xdb\x00\x00?\x01\xc0j\xf0\x0c\x90\xa0~Of\x96",
    b"E\x00\x00%_\x11\x00\x00?\x01\x89\x8fY\x94,\x96Kh\xc1\xa5",
    b"E\x00\x00%\x96\x10\x00\x00?\x01\xecs\xd8u\xf1\x8e\xe16N\x19",
    b"E\x00\x00%B\xcc\x00\x00?\x01<\x02w\x02h\xb2\x7f\xff\x9dV",
    b"E\x00\x00%\x9c#\x00\x00?\x01\xdc\xc4w\xa2\xa2m\x9c\x1cL\xc4",
    b"E\x00\x00%\xfd\x99\x00\x00?\x01\xa2\xea\x005Oq\xa3f\xe8G",
    b"E\x00\x00%\xff\xd2\x00\x00?\x01\xa3\xdc\x9c7z\x01\xeb\x8c\xd6c",
    b"E\x00\x00% 3\x00\x00?\x01 \xef-\xc4\x9eY\xb5-\xb9k",
]
ipv4_headers_bytes = ipv4_original_headers_bytes + ipv4_altered_headers_bytes
